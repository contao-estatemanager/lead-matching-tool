<?php
    $GLOBALS['TL_JAVASCRIPT'][] = 'bundles/estatemanagerleadmatchingtool/scripts/dist/main.js|static';
?>

<?php $this->extend('block_unsearchable'); ?>

<?php $this->block('content'); ?>

<div class="inside">
    <section class="lm-filter">
    <?=$this->txtEstateHeadline?>

    <?=$this->formEstate?>

    <?php if($this->countResults): ?>
        Anzahl: <span data-counter><?=$this->count?></span>
    <?php endif; ?>
    </section>
    <hr/>
    <section class="lm-list">
        <?php if($this->showList): ?>
            <?php if($this->list): ?>
                <?=$this->list?>
                <?=$this->pagination?>
            <?php else: ?>
                <?=$this->empty?>
            <?php endif; ?>
        <?php endif; ?>
    </section>
    <hr/>
    <section class="lm-contact">
        <?=$this->formContact?>
    </section>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function(){
        new LeadMatching({
            configId: <?=$this->id?>,
            proximitySearch: {
                active: !'<?=$this->preciseRegionSearch?>',
                sourceUrl: '<?=Contao\Environment::get('url')?>' // ToDo: Check locale suffix
            },
            countLive: {
                active: !!'<?=$this->countResults?>',
                sourceUrl: '<?=Contao\Environment::get('url')?>' // ToDo: Check locale suffix
            }
        });
    });
</script>

<?php $this->endblock(); ?>
